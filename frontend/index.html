<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MD Vault</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3/dist/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mammoth@1/mammoth.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
</head>
<body>
    <!-- Login Dialog -->
    <div id="login-overlay" class="overlay">
        <div class="win-dialog">
            <div class="title-bar">
                <span class="title-bar-text">Login ‚Äî MD Vault</span>
                <div class="title-bar-controls">
                    <button aria-label="Close" disabled>√ó</button>
                </div>
            </div>
            <div class="dialog-body">
                <div class="dialog-icon">üîë</div>
                <div class="dialog-form">
                    <p>Enter your credentials to access MD Vault.</p>
                    <div class="form-row">
                        <label for="username">Username:</label>
                        <input type="text" id="username" value="admin">
                    </div>
                    <div class="form-row">
                        <label for="password">Password:</label>
                        <input type="password" id="password">
                    </div>
                    <div id="login-error" class="error-text"></div>
                    <div class="dialog-buttons">
                        <button id="login-btn" class="win-btn">OK</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Window -->
    <div id="main-window" class="win-window" style="display:none;">
        <div class="title-bar">
            <span class="title-bar-text">üìÅ MD Vault</span>
            <div class="title-bar-controls">
                <button aria-label="Minimize">‚Äî</button>
                <button aria-label="Maximize">‚ñ°</button>
                <button aria-label="Close" id="logout-btn">√ó</button>
            </div>
        </div>
        <div class="menu-bar">
            <button class="menu-item" id="menu-new">File ‚ñæ</button>
            <button class="menu-item" id="menu-edit">Edit ‚ñæ</button>
            <button class="menu-item" id="menu-view">View ‚ñæ</button>
            <button class="menu-item" id="menu-help">Help ‚ñæ</button>
            <!-- Dropdown menus -->
            <div id="dropdown-file" class="dropdown-menu">
                <button class="dropdown-item" id="btn-new-doc">New Document</button>
                <button class="dropdown-item" id="btn-upload">Upload File...</button>
                <button class="dropdown-item" id="btn-new-folder">New Folder</button>
                <button class="dropdown-item" id="btn-refresh">Refresh</button>
                <hr>
                <button class="dropdown-item" id="btn-logout">Logout</button>
            </div>
            <div id="dropdown-edit" class="dropdown-menu">
                <button class="dropdown-item" id="btn-edit-current">Edit Document</button>
                <button class="dropdown-item" id="btn-delete-current">Delete Document</button>
            </div>
            <div id="dropdown-view" class="dropdown-menu">
                <button class="dropdown-item" id="btn-expand-all">Expand All Folders</button>
                <button class="dropdown-item" id="btn-collapse-all">Collapse All Folders</button>
            </div>
            <div id="dropdown-help" class="dropdown-menu">
                <button class="dropdown-item" id="btn-about">About MD Vault</button>
            </div>
        </div>
        <div class="content-area">
            <div class="tree-panel" id="tree-panel">
                <div class="panel-inset" id="tree-container"></div>
            </div>
            <div class="resize-handle" id="resize-handle"></div>
            <div class="doc-panel" id="doc-panel">
                <div class="panel-inset" id="doc-container">
                    <div class="welcome-msg">
                        <h2>Welcome to MD Vault</h2>
                        <p>Select a document from the tree to view it, or create a new one from File menu.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="status-bar">
            <span id="status-count">0 documents</span>
            <span class="status-separator">|</span>
            <span>Search:</span>
            <input type="text" id="search-input" class="search-input" placeholder="Type and press Enter...">
            <button id="search-btn" class="win-btn-sm">üîç</button>
        </div>
    </div>

    <!-- Upload Dialog -->
    <div id="upload-overlay" class="overlay" style="display:none;">
        <div class="win-dialog">
            <div class="title-bar">
                <span class="title-bar-text">Upload File</span>
                <div class="title-bar-controls">
                    <button aria-label="Close" id="upload-close">√ó</button>
                </div>
            </div>
            <div class="dialog-body">
                <div class="dialog-icon">üìé</div>
                <div class="dialog-form">
                    <p>Select a file to upload (md, pdf, docx, xlsx, images...)</p>
                    <div class="form-row">
                        <label for="upload-file">File:</label>
                        <input type="file" id="upload-file" accept=".md,.txt,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.csv,.json,.yaml,.yml,.xml,.html,.png,.jpg,.jpeg,.gif,.svg,.drawio">
                    </div>
                    <div class="form-row">
                        <label for="upload-project">Project:</label>
                        <input type="text" id="upload-project" placeholder="e.g. HappyKube">
                    </div>
                    <div class="form-row">
                        <label for="upload-tags">Tags:</label>
                        <input type="text" id="upload-tags" placeholder="k8s, docs">
                    </div>
                    <div id="upload-error" class="error-text"></div>
                    <div class="dialog-buttons">
                        <button id="upload-ok" class="win-btn">Upload</button>
                        <button id="upload-cancel" class="win-btn">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- New Folder Dialog -->
    <div id="folder-overlay" class="overlay" style="display:none;">
        <div class="win-dialog">
            <div class="title-bar">
                <span class="title-bar-text">New Folder</span>
                <div class="title-bar-controls">
                    <button aria-label="Close" id="folder-close">√ó</button>
                </div>
            </div>
            <div class="dialog-body">
                <div class="dialog-icon">üìÅ</div>
                <div class="dialog-form">
                    <p>Enter a name for the new folder:</p>
                    <div class="form-row">
                        <label for="folder-name">Name:</label>
                        <input type="text" id="folder-name" placeholder="e.g. NewProject">
                    </div>
                    <div class="dialog-buttons">
                        <button id="folder-ok" class="win-btn">OK</button>
                        <button id="folder-cancel" class="win-btn">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- New/Edit Document Dialog -->
    <div id="editor-overlay" class="overlay" style="display:none;">
        <div class="win-dialog win-dialog-large">
            <div class="title-bar">
                <span class="title-bar-text" id="editor-title">New Document</span>
                <div class="title-bar-controls">
                    <button aria-label="Close" id="editor-close">√ó</button>
                </div>
            </div>
            <div class="dialog-body editor-body">
                <div class="form-row">
                    <label for="doc-title">Title:</label>
                    <input type="text" id="doc-title" style="flex:1">
                </div>
                <div class="form-row">
                    <label for="doc-project">Project:</label>
                    <input type="text" id="doc-project" placeholder="e.g. HappyKube" style="flex:1">
                </div>
                <div class="form-row">
                    <label for="doc-tags">Tags:</label>
                    <input type="text" id="doc-tags" placeholder="k8s, docker, ci-cd" style="flex:1">
                </div>
                <div class="form-row" style="flex:1; flex-direction:column;">
                    <label for="doc-content">Content (Markdown):</label>
                    <textarea id="doc-content"></textarea>
                </div>
                <div class="dialog-buttons">
                    <button id="editor-save" class="win-btn">Save</button>
                    <button id="editor-cancel" class="win-btn">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirm Dialog -->
    <div id="delete-overlay" class="overlay" style="display:none;">
        <div class="win-dialog">
            <div class="title-bar">
                <span class="title-bar-text">Confirm Delete</span>
            </div>
            <div class="dialog-body">
                <div class="dialog-icon">‚ö†Ô∏è</div>
                <div class="dialog-form">
                    <p id="delete-msg">Are you sure you want to delete this document?</p>
                    <div class="dialog-buttons">
                        <button id="delete-yes" class="win-btn">Yes</button>
                        <button id="delete-no" class="win-btn">No</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
